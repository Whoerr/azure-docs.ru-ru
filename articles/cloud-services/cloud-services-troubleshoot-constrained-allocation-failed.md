---
title: Устранение неполадок Констраинедаллокатионфаилед при развертывании облачной службы (классическая модель) в Azure | Документация Майкрософт
description: В этой статье показано, как устранить исключение Констраинедаллокатионфаилед при развертывании облачной службы (классической) в Azure.
services: cloud-services
author: mibufo
ms.author: v-mibufo
ms.service: cloud-services
ms.topic: troubleshooting
ms.date: 02/22/2021
ms.openlocfilehash: 346e7eb77039ab80e6f9dffb8ea8360198040504
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101738295"
---
# <a name="troubleshoot-constrainedallocationfailed-when-deploying-a-cloud-service-classic-to-azure"></a>Устранение неполадок Констраинедаллокатионфаилед при развертывании облачной службы (классической) в Azure

В этой статье вы узнаете об устранении ошибок выделения, когда облачные службы Azure (классические) не могут быть развернуты из-за ограничений выделения ресурсов.

При развертывании экземпляров в облачной службе (классической) или добавлении новых экземпляров веб-служб или рабочих ролей Microsoft Azure выделяет ресурсы для вычислений.

Иногда при выполнении этих операций могут возникать ошибки даже до достижения лимита подписки Azure.

> [!TIP]
> Эта информация также может быть полезна при планировании развертывания служб.

## <a name="symptom"></a>Симптом

В портал Azure перейдите к облачной службе (классическая) и в боковой панели выберите *Журнал операций (классическая модель)* , чтобы просмотреть журналы.

![На рисунке показана колонка журнал операций (классическая).](./media/cloud-services-troubleshoot-constrained-allocation-failed/cloud-services-troubleshoot-allocation-logs.png)

При проверке журналов облачной службы (классическая модель) вы увидите следующее исключение:

|Тип исключения  |Сообщение об ошибке  |
|---------|---------|
|констраинедаллокатионфаилед     |Операция Azure " `{Operation ID}` " завершилась ошибкой с кодом COMPUTE. констраинедаллокатионфаилед. Сведения: сбой при выделении; не удалось удовлетворить ограничения в запросе. Запрошенное новое развертывание службы привязано к территориальной группе, предназначено для выполнения в виртуальной сети, или в этой размещенной службе уже существует развертывание. Любое из этих условий ограничивает новое развертывание использованием определенных ресурсов Azure. Повторите попытку позже или уменьшите размер виртуальной машины или число экземпляров роли. Кроме того, по возможности удалите вышеупомянутые ограничения или попробуйте выполнить развертывание в другом регионе.|

## <a name="cause"></a>Причина

При развертывании первого экземпляра в облачной службе (в промежуточной или рабочей среде) Эта облачная служба закрепляется в кластере.

Со временем ресурсы в этом кластере могут быть полностью использованы. Если облачная служба (классическая) создает запрос на выделение ресурсов, если в закрепленном кластере недостаточно ресурсов, запрос приведет к сбою выделения. Дополнительные сведения см. в разделе [Общие проблемы при выделении](cloud-services-allocation-failures.md#common-issues).

## <a name="solution"></a>Решение

Существующие облачные службы *закреплены* в кластере. Все дальнейшие развертывания облачной службы (классическая модель) будут выполняться в том же кластере.

При возникновении ошибки выделения памяти в этом сценарии рекомендуется выполнить повторное развертывание в новой облачной службе (классической) (и обновить *запись CNAME*).

> [!TIP]
> Это решение, как правило, является самым удачным, поскольку позволяет платформе выбрать все кластеры в соответствующем регионе.

> [!NOTE]
> В этом случае время простоя должно быть нулевым.

1. Разверните рабочую нагрузку в новой облачной службе (классическая модель).
    - Дополнительные инструкции см. в разделе [Создание и развертывание (классическая) руководства по облачным службам](cloud-services-how-to-create-deploy-portal.md) .

    > [!WARNING]
    > Если вы не хотите терять IP-адрес, связанный с этим слотом развертывания, можно использовать [решение 3 — сохранить IP-адрес](cloud-services-allocation-failures.md#solutions).

1. Обновите запись *CNAME* или *A* , чтобы она указывала на трафик в новую облачную службу (классическая модель).
    - Дополнительные инструкции см. в разделе [Настройка пользовательского доменного имени для облачной службы Azure (классическая модель)](cloud-services-custom-domain-name-portal.md#understand-cname-and-a-records) .

1. После перехода на старый сайт нулевого трафика можно удалить старую облачную службу (классическая).
    - Дополнительные инструкции см. в разделе [Удаление развертываний и в классическом виде облачной службы (классическая модель)](cloud-services-how-to-manage-portal.md#delete-deployments-and-a-cloud-service) .
    - Чтобы просмотреть сетевой трафик в облачной службе (классическая модель), см. статью [Общие сведения о мониторинге облачной службы (классическая модель)](cloud-services-how-to-monitor.md).

См. раздел [Устранение неполадок выделения облачной службы (классическая модель) | Документация Майкрософт](cloud-services-allocation-failures.md#common-issues) для дальнейших действий по исправлению.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об ошибках при выделении и фундаментальной информации:

> [!div class="nextstepaction"]
> [Сбои при выделении — облачная служба (классическая)](cloud-services-allocation-failures.md)

Если проблема с Azure не устранена в этой статье, посетите форумы Azure в [MSDN и Stack overflow](https://azure.microsoft.com/support/forums/). Описание своей проблемы можно опубликовать на этих форумах или [в Twitter (@AzureSupport)](https://twitter.com/AzureSupport). Также можно отправить запрос в службу поддержки Azure. Чтобы отправить такой запрос, на странице [поддержки Azure](https://azure.microsoft.com/support/options/) щелкните *Получить поддержку*.
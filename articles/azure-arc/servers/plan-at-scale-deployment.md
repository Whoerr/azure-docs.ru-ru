---
title: Планирование масштабного развертывания серверов с поддержкой ARC в Azure
description: Узнайте, как включить большое количество компьютеров в серверы с поддержкой ARC в Azure, чтобы упростить настройку функций обеспечения безопасности, управления и мониторинга в Azure.
ms.date: 02/23/2021
ms.topic: conceptual
ms.openlocfilehash: fd02e7c0b4d65efde13fbc428a15d60adab174d4
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101693220"
---
# <a name="planing-for-an-at-scale-deployment-of-azure-arc-enabled-servers"></a>Планирование масштабного развертывания серверов с поддержкой ARC в Azure

Развертывание службы ИТ-инфраструктуры или бизнес приложения является сложной задачей для любой компании. Чтобы это хорошо выполнялось и не возникало незавершенных и незапланированных затрат, необходимо тщательно спланировать его, чтобы убедиться в том, что вы все равно готовы. Чтобы спланировать развертывание параллельно развертываемых серверов Azure Arc, он должен охватывать критерии проектирования и развертывания, которые должны быть выполнены для успешного выполнения задач, необходимых для поддержки масштабного развертывания.

Чтобы развертывание было беспрепятственно продолжено, ваш план должен четко понять:

* Роли и обязанности.
* Инвентаризация физических серверов или виртуальных машин, чтобы убедиться, что они соответствуют требованиям к сети и системе.
* Набор навыков и обучение необходимы для успешного развертывания и непрерывного управления.
* Критерии принятия и сведения об успешном отслеживании успеха.
* Средства или методы, используемые для автоматизации развертываний.
* Выявлены риски и планы по устранению рисков, чтобы избежать задержек, нарушений и т. д.
* Как избежать сбоев при развертывании.
* Что такое путь эскалации при возникновении серьезных проблем?

Цель этой статьи — убедиться, что вы готовы к успешному развертыванию серверов с поддержкой ARC в Azure на нескольких производственных физических серверах или виртуальных машинах в вашей среде.

## <a name="prerequisites"></a>Предварительные требования

* Компьютеры работают под управлением [поддерживаемой операционной системы](agent-overview.md#supported-operating-systems) для агента подключенного компьютера.
* Компьютеры могут подключаться из локальной сети или другой облачной среды к ресурсам в Azure либо напрямую, либо через прокси-сервер.
* Чтобы установить и настроить для серверов с поддержкой Arc подключенный агент компьютера, учетную запись с повышенными правами (то есть администратором или корневым каталогом) на компьютерах.
* Чтобы подключить компьютеры, необходимо быть членом роли **Подключение компьютеров, подключенных к Azure**.
* Для чтения, изменения и удаления компьютера вы являетесь членом роли **администратора ресурсов на компьютере, подключенном к Azure** .

## <a name="pilot"></a>Пилотное развертывание

Перед развертыванием на всех рабочих компьютерах Начните с оценки этого процесса развертывания, прежде чем внедрять его в своей среде. Для пилотного проекта следует определить репрезентативную выборку компьютеров, которые не являются критически важными для вашей компании. Необходимо обеспечить достаточное время для запуска пилотного проекта и оценить его влияние: Мы рекомендуем не менее 30 дней.

Создайте формальный план, описывающий область действия и сведения о пилотном проекте. Ниже приведен пример того, что должен включать план, чтобы помочь вам начать работу.

* Цели. описывает бизнес-и технические драйверы, которые привели к решению о необходимости пилотного развертывания.
* Критерии выбора — указывает критерии, используемые для выбора аспектов решения, которые будут показаны в пилотном проекте.
* Scope — описание области пилотного проекта, которая включает в себя не только компоненты решения, но и ожидаемое расписание, продолжительность пилотного проекта и число целевых компьютеров.
* Критерии успеха и метрики — определяют критерии успеха пилотного проекта и конкретные меры, используемые для определения уровня успеха.
* План обучения — описывает план для инженеров системы обучения, администраторов и т. д., которые не знакомы с Azure и ИТ-службами во время пилотного развертывания.
* План перехода — описывает стратегию и критерии, используемые для перехода от пилотного развертывания к производству.
* Откат — описывает процедуры отката пилотного развертывания до состояния перед развертыванием.
* Риски — список всех определенных рисков по проведению пилотного развертывания и связанному с развертыванием в рабочей среде.

## <a name="phase-1-build-a-foundation"></a>Этап 1. Создание основы

На этом этапе системные инженеры или Администраторы передают основные функции в своей подписке Azure для начала работы, прежде чем включать компьютеры для управления с помощью серверов с поддержкой Arc и других служб Azure.

|Задача |Подробный сведения |Duration |
|-----|-------|---------|
| [Создайте группу ресурсов](../../azure-resource-manager/management/manage-resource-groups-portal.md#create-resource-groups). | Выделенная группа ресурсов включает только серверы с поддержкой Arc и централизованное управление и мониторинг этих ресурсов. | Один час |
| Примените [теги](../../azure-resource-manager/management/tag-resources.md) , чтобы помочь организовать компьютеры. | Оцените и разработайте [стратегию тегов](/cloud-adoption-framework/decision-guides/resource-tagging/) , ориентированную на ИТ, которая поможет снизить сложность управления серверами с поддержкой Arc и упростить принятие решений по управлению. | Один день |
| Проектирование и развертывание [журналов Azure Monitor](../../azure-monitor/logs/data-platform-logs.md) | Оцените [вопросы проектирования и развертывания](../../azure-monitor/logs/design-logs-deployment.md) , чтобы определить, должна ли Организация использовать существующую или реализовать другую рабочую область log Analytics для хранения собранных данных журналов с гибридных серверов и компьютеров. <sup>1</sup> | Один день |
| [Разработка плана управления политиками Azure](../../governance/policy/overview.md) | Определите, как вы будете реализовывать управление гибридными серверами и компьютерами в области подписки или группы ресурсов с помощью политики Azure. | Один день |
| Настройка [управления доступом на основе ролей](../../role-based-access-control/overview.md) (RBAC) | Разрабатывайте план доступа, чтобы управлять доступом к серверам с поддержкой Arc и возможностью просмотра данных из других служб и решений Azure. | Один день |
| Выявление компьютеров с уже установленным агентом Log Analytics | Выполните следующий запрос журнала в [log Analytics](../../azure-monitor/logs/log-analytics-overview.md) для поддержки преобразования существующих развертываний агента log Analytics в агент, управляемый расширением:<br> Пульс <br> &#124;, где TimeGenerated > назад (30d) <br> &#124;, где ResourceType = = "machines" и (Компутеренвиронмент = = "non-Azure") <br> &#124; суммировать по компьютерам, ResourceProvider, ResourceType, Компутеренвиронмент | Один час |

<sup>1</sup> важное замечание при оценке структуры log Analytics рабочей области — интеграция со службой автоматизации Azure для поддержки ее Управление обновлениями, отслеживание изменений и инвентаризации, а также центра безопасности Azure и Sentinel. Если в вашей организации уже есть учетная запись службы автоматизации и включены функции управления, связанные с Log Analytics рабочей областью, оцените, можно ли централизовать и упростить операции управления, а также сократить затраты, используя существующие ресурсы и создав дубликаты учетной записи, рабочей области и т. д.

## <a name="phase-2-deploy-arc-enabled-servers"></a>Этап 2. Развертывание серверов с поддержкой Arc

Далее мы добавим в основу, размещенную на этапе 1, подготавливая развертывание и выполняя установку агента.

|Задача |Подробный сведения |Duration |
|-----|-------|---------|
| Скачать предварительно определенный скрипт установки | Просмотрите и настройте предварительно определенный скрипт установки для масштабируемого развертывания агента подключенного компьютера для поддержки требований к автоматическому развертыванию.<br><br> Пример использования ресурсов адаптации для масштабирования:<br><br> * [Базовый скрипт развертывания в масштабе](servers/onboard-service-principal.md)<br><br> * [Масштабирование при адаптации VMware vSphere виртуальных машин Windows Server](https://github.com/microsoft/azure_arc/blob/master/azure_arc_servers_jumpstart/docs/vmware_scaled_powercli_win.md)<br><br> * [Масштабирование при адаптации VMware vSphere виртуальных машин Linux](https://github.com/microsoft/azure_arc/blob/master/azure_arc_servers_jumpstart/docs/vmware_scaled_powercli_linux.md)<br><br> * [Масштабирование экземпляров AWS EC2 с помощью Ansible](https://github.com/microsoft/azure_arc/blob/master/azure_arc_servers_jumpstart/docs/aws_scale_ansible.md)<br><br> * [Масштабное развертывание с использованием удаленного взаимодействия PowerShell](https://docs.microsoft.com/azure/azure-arc/servers/onboard-powershell) (только для Windows)| Один или несколько дней в зависимости от требований, организационных процессов (например, изменения и Release Management) и используемого метода автоматизации. |
| [Создание субъекта-службы](onboard-service-principal.md#create-a-service-principal-for-onboarding-at-scale) |Создайте субъект-службу для подключения компьютеров в неинтерактивном режиме с помощью Azure PowerShell или с портала.| Один час |
| Развертывание агента подключенного компьютера на целевых серверах и компьютерах |Используйте средство автоматизации для развертывания сценариев на серверах и их подключения к Azure.| Один или несколько дней в зависимости от плана выпуска и в случае поэтапного развертывания. |

## <a name="phase-3-manage-and-operate"></a>Этап 3. Управление и работа

Этап 3 видит администраторов или системных инженеров, позволяющих автоматизировать выполняемые вручную задачи для управления агентом подключенного компьютера и компьютером во время его жизненного цикла.

|Задача |Подробный сведения |Duration |
|-----|-------|---------|
|Создание оповещения Работоспособность ресурсов |Если сервер перестает отправлять пакеты пульса в Azure дольше 15 минут, это может означать, что оно отключено, сетевое подключение заблокировано или агент не запущен. Создайте план реагирования и изучения этих инцидентов и используйте [работоспособность ресурсов оповещения](../..//service-health/resource-health-alert-monitor-guide.md) , чтобы получать уведомления при их запуске.<br><br> При настройке оповещения укажите следующие настройки:<br> **Тип ресурса**  =  **Серверы с поддержкой Arc Azure**<br> **Текущее состояние ресурса**  =  **Недоступно**<br> **Предыдущее состояние ресурса**  =  **Доступно** | Один час |
|Создание оповещения Azure Advisor | Для получения наилучших сведений и последних исправлений безопасности и ошибок рекомендуется своевременно поддерживать агент серверов с поддержкой Arc Azure. Неактуальные агенты будут идентифицированы с помощью [оповещения Azure Advisor](../../advisor/advisor-alerts-portal.md).<br><br> При настройке оповещения укажите следующие настройки:<br> **Тип рекомендации**  =  **Обновление до последней версии агента подключенного компьютера Azure** | Один час |
|[Назначение политик Azure](../../governance/policy/assign-policy-portal.md) области действия подписки или группы ресурсов |Назначьте политику **включения Azure Monitor для виртуальных машин** и другие, которые соответствуют вашим потребностям в области подписки или группы ресурсов, чтобы убедиться, что все серверы с поддержкой Arc автоматически настроены для мониторинга с Azure Monitor для виртуальных машин.| Различается |
|[Включение Управление обновлениями для серверов с поддержкой Arc](../../automation/update-management/enable-from-automation-account.md) |Настройте Управление обновлениями в службе автоматизации Azure для управления обновлениями операционной системы для виртуальных машин Windows и Linux, зарегистрированных на серверах с поддержкой ARC. | 15 минут |

## <a name="next-steps"></a>Дальнейшие действия

* Сведения об устранении неполадок можно найти в разделе [руководство по устранению неполадок подключенного компьютера](troubleshoot-agent-onboard.md).

* Узнайте, как упростить развертывание с помощью других служб Azure, таких как [Настройка состояния](../../automation/automation-dsc-overview.md) службы автоматизации Azure и другие поддерживаемые [расширения виртуальных машин Azure](manage-vm-extensions.md).
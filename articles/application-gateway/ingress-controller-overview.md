---
title: Что такое контроллер входящего трафика шлюза приложений Azure?
description: В этой статье приводятся общие сведения о контроллере входящего трафика шлюза приложений.
services: application-gateway
author: caya
ms.service: application-gateway
ms.topic: article
ms.date: 03/02/2021
ms.author: caya
ms.openlocfilehash: 2564fd38056241fd48f58f5f6039bf64f92b6741
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101714414"
---
# <a name="what-is-application-gateway-ingress-controller"></a>Что такое входной контроллер шлюза приложений?
Контроллер входящего трафика шлюза приложений (АГИК) — это приложение Kubernetes, которое позволяет клиентам [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/) использовать собственный [шлюз](https://azure.microsoft.com/services/application-gateway/) нагрузки уровня 7 для Microsoft Azure, чтобы предоставить доступ к облачному программному обеспечению через Интернет. АГИК отслеживает кластер Kubernetes, на котором он размещен, и постоянно обновляет шлюз приложений, чтобы выбранные службы были доступны в Интернете.

Входной контроллер работает в своем собственном модуле в AKS клиента. АГИК отслеживает подмножество ресурсов Kubernetes для внесения изменений. Состояние кластера AKS преобразуется в конфигурацию шлюза приложений и применяется к [Azure Resource Manager (ARM)](../azure-resource-manager/management/overview.md).

## <a name="benefits-of-application-gateway-ingress-controller"></a>Преимущества контроллера входящего трафика шлюза приложений
АГИК помогает устранить необходимость создания другой подсистемы балансировки нагрузки или общедоступного IP-адреса перед кластером AKS и избежать нескольких прыжков в пути данных до достижения запросов к кластеру AKS. Шлюз приложений обращается к модулям Pod напрямую с помощью частных IP-адресов и не требует Нодепорт или Кубепрокси Services. Это также повышает производительность развертывания.

Входной контроллер поддерживается исключительно Standard_v2 и WAF_v2 SKU, что также приводит к преимуществам автоматического масштабирования. Шлюз приложений может реагировать в ответ на увеличение или уменьшение нагрузки на трафик и соответствующим образом масштабировать, не используя ресурсы из кластера AKS.

Использование шлюза приложений в дополнение к АГИК также помогает защитить кластер AKS, предоставляя политику TLS и функцию брандмауэра веб-приложения (WAF).

![Шлюз приложений Azure + AKS](./media/application-gateway-ingress-controller-overview/architecture.png)

АГИК настраивается с помощью [ресурса](https://kubernetes.io/docs/user-guide/ingress/)входящих данных Kubernetes, а также службы, развертываний и модулей Pod. Он предоставляет ряд функций, использующих балансировщик нагрузки уровня "Стандартный" шлюза приложений Azure. Вот некоторые из них:
  - Маршрутизация URL-адресов
  - Сходство на основе файлов cookie,
  - Терминирование TLS
  - Сквозной протокол TLS
  - Поддержка общедоступных, частных и гибридных веб-сайтов
  - Интегрированный брандмауэр веб-приложения

## <a name="difference-between-helm-deployment-and-aks-add-on"></a>Разница между развертыванием Helm и AKS Add-On
Существует два способа развертывания АГИК для кластера AKS. Первый способ — через Helm; второй — через AKS в качестве надстройки. Основное преимущество развертывания АГИК в качестве надстройки AKS заключается в том, что это гораздо проще, чем развертывание с помощью Helm. Для новой установки можно развернуть новый шлюз приложений и новый кластер AKS с АГИК, включенным в качестве надстройки, в одной строке Azure CLI. Надстройка также является полностью управляемой службой, которая предоставляет дополнительные преимущества, такие как автоматическое обновление и расширенная поддержка. Оба способа развертывания надстройки АГИК (Helm и AKS) полностью поддерживаются корпорацией Майкрософт. Кроме того, надстройка обеспечивает лучшую интеграцию с AKS в качестве первой надстройки класса.

Надстройка АГИК все еще развертывается как Pod в кластере AKS клиента, однако существует ряд различий между версией развертывания Helm и версией надстройки АГИК. Ниже приведен список различий между двумя версиями: 
  - Невозможно изменить значения развертывания Helm в надстройке AKS:
    - `verbosityLevel` по умолчанию будет иметь значение 5
    - `usePrivateIp` по умолчанию будет иметь значение false; Это может быть перезаписано [заметкой use-Private-IP](ingress-controller-annotations.md#use-private-ip)
    - `shared` не поддерживается в надстройке 
    - `reconcilePeriodSeconds` не поддерживается в надстройке
    - `armAuth.type` не поддерживается в надстройке
  - АГИК, развернутый через Helm, поддерживает Прохибитедтаржетс, что означает, что АГИК может настроить шлюз приложений специально для кластеров AKS, не затрагивая другие существующие серверные возможности. Надстройка АГИК сейчас не поддерживает эту возможность. 
  - Так как надстройка АГИК является управляемой службой, клиенты автоматически будут обновлены до последней версии надстройки АГИК, в отличие от АГИК, развернутых с помощью Helm, где клиент должен вручную обновить АГИК. 

> [!NOTE]
> Клиенты могут развертывать только одну надстройку АГИК в кластере AKS, и каждая надстройка АГИК в настоящее время может быть назначена только одному шлюзу приложений. Для развертываний, требующих более одного АГИК для каждого кластера или нескольких Агикс, предназначенных для одного шлюза приложений, продолжайте использовать АГИК, развернутые через Helm. 

## <a name="next-steps"></a>Дальнейшие действия
- [**AKS Add-On нуля Deployment**](tutorial-ingress-controller-add-on-new.md): инструкции по установке надстройки АГИК, AKS и шлюза приложений в инфраструктуре пустого материала.
- [**AKS Add-On серия статей Brownfield Deployment**](tutorial-ingress-controller-add-on-existing.md): Установка агик надстройки в кластере AKS с существующим шлюзом приложений.
- [**Развертывание Helm нуля**](ingress-controller-install-new.md): Установка агик с помощью Helm, нового кластера AKS и нового шлюза приложений в инфраструктуре пустого материала.
- [**Развертывание Helm серия статей Brownfield**](ingress-controller-install-existing.md). Развертывание агик через Helm в существующем кластере AKS и шлюзе приложений.
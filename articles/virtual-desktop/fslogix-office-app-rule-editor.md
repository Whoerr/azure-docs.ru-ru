---
title: Установка Microsoft Office Фслогикс контейнеров приложений в виртуальном рабочем столе Windows — Azure
description: Использование редактора правил приложений для создания контейнера приложений Фслогикс с Office в виртуальном рабочем столе Windows.
author: Heidilohr
ms.topic: conceptual
ms.date: 02/23/2021
ms.author: helohr
manager: lizross
ms.openlocfilehash: 7d66d370f321323ec1aeb45ad0fe628904b14fe6
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101747146"
---
# <a name="install-microsoft-office-using-fslogix-application-containers"></a>Установка Microsoft Office с помощью контейнеров приложений Фслогикс

Вы можете быстро и эффективно установить Microsoft Office с помощью контейнера приложений Фслогикс в качестве шаблона для других виртуальных машин в пуле узлов.

Вот почему использование контейнера приложения Фслогикс поможет ускорить установку:

- Разгрузка приложений Office в контейнер приложения снижает требования к размеру диска C.
- Создание моментальных снимков или резервных копий виртуальной машины занимает меньше ресурсов.
- Создание автоматизированного конвейера путем обновления одного образа упрощает обновление виртуальных машин.
- Для установки Office (и других приложений) на все виртуальные машины в развертывании виртуальных рабочих столов Windows требуется только один образ.

В этой статье показано, как настроить контейнер приложений Фслогикс с Office.

## <a name="requirements"></a>Требования

Для настройки редактора правил потребуются следующие действия.

- Виртуальная машина под Windows без установленного пакета Office
- копия Office
- копия Фслогикс, установленная в развертывании
- Общая сетевая папка, к которой все виртуальные машины в пуле узлов имеют доступ только для чтения.

## <a name="install-office"></a>Установка Office

Чтобы установить Office на VHD или VHDX, включите протокол удаленного рабочего стола на виртуальной машине, а затем следуйте инструкциям в [статье Установка Office на основной образ VHD](install-office-on-wvd-master-image.md). При установке убедитесь, что вы используете [правильные лицензии](overview.md#requirements).

>[!NOTE]
>Для виртуальных рабочих столов Windows требуется активация общего доступа к компьютеру (SCA).

## <a name="install-fslogix"></a>Установка Фслогикс

Чтобы установить Фслогикс и редактор правил, следуйте инструкциям в статье [Загрузка и установка фслогикс](/fslogix/install-ht).

## <a name="create-and-prepare-a-vhd-to-store-office"></a>Создание и подготовка виртуального жесткого диска для хранения Office

Далее необходимо создать и подготовить образ VHD для использования редактора правил:

1. Откройте командную строку от имени учетной записи администратора. и выполните следующую команду:

    ```cmd
        taskkill /F /IM MicrosoftEdge.exe /T
    ```

    >[!NOTE]
    > Не забудьте оставить пустые пробелы, отображаемые в этой команде.

2. Затем выполните следующую команду:

    ```cmd
    sc queryex type=service state=all | find /i "ClickToRunSvc"
    ```
    
   Если служба найдена, перезапустите виртуальную машину, прежде чем продолжить выполнение шага 3.

    ```cmd
    net stop ClickToRunSvc
    ```

3. После этого перейдите в раздел **Program Files**  >  **фслогикс**  >  **Apps** и выполните следующую команду, чтобы создать целевой виртуальный жесткий диск:

    ```cmd
    frx moveto-vhd -filename <path to network share>\office.vhdx -src "C:\Program Files\Microsoft Office" -size-mbs 5000 
    ```

    Виртуальный жесткий диск, созданный с помощью этой команды, должен содержать \\ папку C: Program files \\ Microsoft Office.

    >[!NOTE]
    >Если вы видите ошибки, удалите Office и начните с шага 1.

## <a name="configure-the-rule-editor"></a>Настройка редактора правил

Теперь, когда вы подготовили образ, необходимо настроить редактор правил и создать файл для хранения правил.

1. Перейдите в раздел **Program Files**  >  **фслогикс**  >  **Apps** и запустите **RuleEditor.exe**.

2. Выберите **файл**  >  **создать**  >  **создать** , чтобы создать новый набор правил, а затем сохраните это правило в локальной папке.

3. Выберите **пустой набор правил**, а затем нажмите кнопку **ОК**.

4. Нажмите кнопку **+**. Откроется окно **Добавление правила** . Это приведет к изменению параметров в диалоговом окне **Добавление правила** .

5. В раскрывающемся меню выберите **правило контейнер приложения (VHD)**.

6. Введите **C: \\ Program files \\ Microsoft Office** в поле **Папка** .

7. В поле **файл диска** выберите **\<path\> \\ Office. VHD** из раздела **Создание целевого виртуального жесткого диска** .

8. Щелкните **ОК**.

9. Перейдите в рабочую папку на **языке C: \\ Пользователи \\ \<username\> \\ задокументированы \\ наборы правил фслогикс** и ищут файлы FRx и ФКСА. Эти файлы необходимо переместить в папку Rules, расположенную в папке **C: \\ Program Files \\ фслогикс \\ Apps \\** , чтобы правила начали работать.

10. Выберите **Применить правила к системе** , чтобы правила вступили в силу.

     >[!NOTE]
     > Необходимо применить файлы правил приложений ко всем узлам сеансов.

## <a name="next-steps"></a>Дальнейшие действия

Если вы хотите узнать больше о Фслогикс, ознакомьтесь с [документацией по фслогикс](/fslogix/).